{% extends 'header.html' %}{% load static %}{% block content %}
<link rel="stylesheet" href="{% static 'alerts.css' %}" >

<body>
  <div id="main"><div id="title"> <h3>Alerts</h3>{{statement.set}}</div>
  {% if count %}
  <div class="card" style="background-color: #ffffff;">
    
    <table>
        <thead>
            <tr>
                <th>Alert Id</th>
                <th>Transaction Id</th>
                <th>Staff Id</th>
                <th>Timestamp</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for items in set %}
                <tr>
                    <td>  {{ items.alertid }}</td>
                    <td>{{ items.transactionid }}</td>
                    <td>{{ items.staffid }}</td>
                    <td>{{ items.timestamp }}</td>
                    <td>
                        <form method="post" action="{% url 'alerts' %}">
                            <input type="hidden" name="item_value" value="{{ items }}">
                            {% csrf_token %}
                            <button type="submit" class="approve-btn" name="action" value="approve">Approve transaction</button>
                            <button type="submit" class="reject-btn" name="action" value="reject">Stop transaction</button>
                        </form>
                    </td>
                    <td><img src="{% static 'options_13525834.png' %}"id= 'menudots'> </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
  </div>{% endif %}
</div>

<!-- <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script>
    // Function to handle the AJAX request
    function updateContent() {
        $.ajax({
            type: 'POST',
            url: 'http://127.0.0.1:8000/transactions',
            data: {},
            success: function(response) {
                // Update your content based on the API response
                console.log(response);

                // Check if the conditions are met to refresh the page
                if (response.prediction === 'fraud' && response.mode === 'manual') {
                    location.reload();
                  }
                },

            
            error: function(error) {
                console.error(error);
            }
        });
    }

    // Attach event listeners to your forms to prevent the default form submission
    $('form').submit(function(event) {
        event.preventDefault();

        // Call the updateContent function
        updateContent();
    });
</script> -->
</body>{% endblock %}
</html>