{% extends 'header.html' %}
{% block content %}
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel="stylesheet" href="{% static 'homepage.css' %}">
</head>

<body>
    <div id="main">
        <p>Hello, {{content.set}}</p>
        <p>Welcome to Imara.</p>

        <form id="dataCollectionForm"onsubmit="submitForm(event)">
            {% csrf_token %}


            <div>
                <button id="showCustomTimeBtn" type="button">Time View</button><br>
                <div id="custom-time-dropdown" style="display: none;">
                    <label for="custom_start_date">Start Date:</label>
                    <input type="date" id="custom_start_date" name="custom_start_date" value="2020-01-01">

                    <label for="custom_end_date">End Date:</label>
                    <input type="date" id="custom_end_date" name="custom_end_date" value="2034-12-31">

                    <!-- Your time view options dropdown for custom time -->
                    <label for="customTimeOptions">Custom Time View:</label>
                    <select id="customTimeOptions" name="customTimeOptions">
                        <option value="lastDay">Last Day</option>
                        <option value="lastWeek">Last Week</option>
                        <option value="lastMonth">Last Month</option>
                        <option value="lastThreeMonths">Last Three Months</option>
                        <option value="lastSixMonths">Last Six Months</option>
                        <option value="lastYear">Last Year</option>
                        <option value="allTime"  selected>All Time</option> 
                    </select>

                    <!-- Submit button for custom time selection -->
                    <button id="customTimeSubmitBtn" type="button">Apply</button>
                </div>
            </div>

            <!-- For Stations -->
            <button id="showStationsBtn" type="button">Stations view</button>
            <div id="station-dropdown" style="display: none;">
                {% for item in general_stats.stations %}
                    <label>
                        <input type="checkbox" name="stations" value="{{ item }}"> {{ item }}<br>
                    </label>
                {% endfor %}
            </div>

            <!-- For Locations -->
            <!-- <button id="showLocationsBtn" type="button">Locations view</button>
            <div id="location-dropdown" style="display: none;">
                {% for item in general_stats.locations %}
                    <label>
                        <input type="checkbox" name="locations" value="{{ item }}"> {{ item }}<br>
                    </label>
                {% endfor %}
            </div> -->

            <button type="submit" >Submit</button>
        </form>
    </div>

   
  <br>
<script>
    // Pass the general_stats dictionary to JavaScript
    var generalStats = {{ general_stats|safe }};
</script>
 


<div class="card cards1" style="background-color: #3498db;">
  <h3>Transactions</h3>
  <div class="transactions-info">
    <div class="transactions-column">
      <h4>Predicted</h4>
      <p>{{general_stats.predicted_transactions}}</p>
    </div>
    <div class="transactions-column">
      
      <h4>Pending</h4>
      <p>{{general_stats.pending_transactions}}</p>
    </div>
  </div>
</div>
<div class="card cards2"style="background-color: #e74c3c;">
  <h3>Alerts</h3>
  <div class="transactions-info">
    <div class="transactions-column">
      <h4>Total alerts</h4>
      <p>{{general_stats.all_alerts}}</p>
    </div>
    <div class="transactions-column">
      <h4>Pending alerts</h4>
      <p>{{general_stats.waiting}}</p>
    </div>
    <div class="transactions-column">
      
      <h4>Approval Rate</h4>
      <p>{{general_stats.approval_rate}}%</p>
    </div>
  </div>
</div><br>
<!-- <div class="card cards" style="background-color: #3498db;">
  <h3>All reports</h3>
  <p>{{general_stats.all_reports}}</p>
</div><br> -->

<div class="card pies"style="background-color: #fff;">
  <h3 >Approval</h3>
  <div class="card"id="pieChart2"></div>
</div>
<div class="card pies"style="background-color: #fff;">
  <h3 >Reports</h3>
  <div class="card"id="pieChart"></div>
</div>
<div class="card pies2" style="background-color: #fff;">
  <h3>Hourly Average Transaction Count</h3>
  <div class="card" id="barChart"></div>
</div>
<script src="https://d3js.org/d3.v7.min.js"></script>
<!--<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>-->
<script src="{% static 'homepage.js' %}"></script>
{% endblock %}

{% include 'footer.html' %}
</div>
</body>

